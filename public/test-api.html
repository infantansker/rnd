<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
</head>
<body>
    <h1>API Configuration Test</h1>
    <div id="output"></div>

    <script>
        // Simulate the API configuration logic
        function isDevelopment() {
            // Check if we're running on localhost or 127.0.0.1
            if (typeof window !== 'undefined') {
                return window.location.hostname === 'localhost' || 
                       window.location.hostname === '127.0.0.1' ||
                       window.location.hostname.startsWith('192.168.') || // Common local network IPs
                       window.location.hostname.startsWith('10.'); // Common local network IPs
            }
            
            // For Node.js environment
            return process.env.NODE_ENV === 'development';
        }

        function getApiBaseUrl() {
            // In development, use localhost with the correct port (5001)
            if (isDevelopment()) {
                return 'http://localhost:5001';
            }
            
            // In production, use the same origin (relative URLs)
            // This assumes the backend is served from the same domain
            return '';
        }

        function getApiUrl(endpoint) {
            const baseUrl = getApiBaseUrl();
            
            // If baseUrl is empty (production), return relative URL
            if (!baseUrl) {
                return endpoint.startsWith('/') ? endpoint : `/${endpoint}`;
            }
            
            // In development, combine base URL with endpoint
            return `${baseUrl}${endpoint.startsWith('/') ? endpoint : `/${endpoint}`}`;
        }

        // Test the functions
        const output = document.getElementById('output');
        output.innerHTML = `
            <p><strong>Window location hostname:</strong> ${window.location.hostname}</p>
            <p><strong>Is development:</strong> ${isDevelopment()}</p>
            <p><strong>Base URL:</strong> ${getApiBaseUrl()}</p>
            <p><strong>API URL for /api/create-order:</strong> ${getApiUrl('/api/create-order')}</p>
            <p><strong>API URL for /api/health:</strong> ${getApiUrl('/api/health')}</p>
        `;
    </script>
</body>
</html>